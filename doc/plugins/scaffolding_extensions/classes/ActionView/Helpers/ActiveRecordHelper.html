<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: ActionView::Helpers::ActiveRecordHelper</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">ActionView::Helpers::ActiveRecordHelper</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/vendor/plugins/scaffolding_extensions/lib/scaffolding_extensions_rb.html">
                vendor/plugins/scaffolding_extensions/lib/scaffolding_extensions.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
Changes the default scaffolding of new/edit forms to handle associated
records, and uses a table to display the form.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000017">all_input_tags</a>&nbsp;&nbsp;
      <a href="#M000019">all_input_tags_wrapper</a>&nbsp;&nbsp;
      <a href="#M000023">association_ajax_select_tag</a>&nbsp;&nbsp;
      <a href="#M000022">association_select_tag</a>&nbsp;&nbsp;
      <a href="#M000021">default_input_block</a>&nbsp;&nbsp;
      <a href="#M000018">input_tag_label_and_widget</a>&nbsp;&nbsp;
      <a href="#M000020">input_tag_wrapper</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000017" class="method-detail">
        <a name="M000017"></a>

        <div class="method-heading">
          <a href="#M000017" class="method-signature">
          <span class="method-name">all_input_tags</span><span class="method-args">(record, record_name, options)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Takes record&#8217;s scaffold_fields (or specified fields) and creates the
necessary form fields html fragment. Uses a table by default so that
everything lines up nicely.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000017-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000017-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/scaffolding_extensions/lib/scaffolding_extensions.rb, line 405</span>
405:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">all_input_tags</span>(<span class="ruby-identifier">record</span>, <span class="ruby-identifier">record_name</span>, <span class="ruby-identifier">options</span>)
406:         <span class="ruby-identifier">input_block</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:input_block</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">default_input_block</span>
407:         <span class="ruby-identifier">rows</span> = (<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:fields</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">scaffold_fields</span>).<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field</span><span class="ruby-operator">|</span>
408:           <span class="ruby-identifier">input_block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">record_name</span>, <span class="ruby-identifier">record</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">reflect_on_association</span>(<span class="ruby-identifier">field</span>.<span class="ruby-identifier">to_sym</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">column_for_attribute</span>(<span class="ruby-identifier">field</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">field</span>) 
409:         <span class="ruby-keyword kw">end</span>
410:         <span class="ruby-identifier">all_input_tags_wrapper</span>(<span class="ruby-identifier">record</span>, <span class="ruby-identifier">rows</span>)
411:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000019" class="method-detail">
        <a name="M000019"></a>

        <div class="method-heading">
          <a href="#M000019" class="method-signature">
          <span class="method-name">all_input_tags_wrapper</span><span class="method-args">(record, rows)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Wrap all input tags (table rows) in a table
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000019-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000019-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/scaffolding_extensions/lib/scaffolding_extensions.rb, line 426</span>
426:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">all_input_tags_wrapper</span>(<span class="ruby-identifier">record</span>, <span class="ruby-identifier">rows</span>)
427:         <span class="ruby-node">&quot;\n&lt;table class='#{record.class.scaffold_table_class :form}'&gt;&lt;tbody&gt;\n#{rows.join}&lt;/tbody&gt;&lt;/table&gt;\n&quot;</span>
428:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000023" class="method-detail">
        <a name="M000023"></a>

        <div class="method-heading">
          <a href="#M000023" class="method-signature">
          <span class="method-name">association_ajax_select_tag</span><span class="method-args">(id, record, reflection)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a select box displaying the records for the associated model that
are not already associated with this record. If scaffold autocompleting is
used, uses an autocompleting text box.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000023-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000023-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/scaffolding_extensions/lib/scaffolding_extensions.rb, line 457</span>
457:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">association_ajax_select_tag</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">record</span>, <span class="ruby-identifier">reflection</span>)
458:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">scaffold_use_auto_complete</span>
459:           <span class="ruby-identifier">scaffold_text_field_tag_with_auto_complete</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>)
460:         <span class="ruby-keyword kw">else</span>
461:           <span class="ruby-identifier">singular_class</span> = <span class="ruby-identifier">record</span>.<span class="ruby-identifier">class</span>
462:           <span class="ruby-identifier">foreign_key</span> = <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:foreign_key</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">singular_class</span>.<span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">classify</span>.<span class="ruby-identifier">foreign_key</span>
463:           <span class="ruby-identifier">association_foreign_key</span> = <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:association_foreign_key</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">classify</span>.<span class="ruby-identifier">foreign_key</span>
464:           <span class="ruby-identifier">join_table</span> = <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:join_table</span>] <span class="ruby-operator">||</span> ( <span class="ruby-identifier">singular_class</span>.<span class="ruby-identifier">table_name</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">table_name</span> <span class="ruby-value">? </span><span class="ruby-value str">'#{singular_class.table_name}_#{reflection.klass.table_name}'</span> <span class="ruby-operator">:</span> <span class="ruby-value str">'#{reflection.klass.table_name}_#{singular_class.table_name}'</span>)
465:           <span class="ruby-identifier">items</span> = <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">scaffold_select_order</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span>[<span class="ruby-node">&quot;#{reflection.klass.table_name}.#{reflection.klass.primary_key} NOT IN (SELECT #{association_foreign_key} FROM #{join_table} WHERE #{join_table}.#{foreign_key} = ?)&quot;</span>, <span class="ruby-identifier">record</span>.<span class="ruby-identifier">id</span>], <span class="ruby-identifier">:include=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">scaffold_include</span>)
466:           <span class="ruby-identifier">select_tag</span>(<span class="ruby-identifier">id</span>, <span class="ruby-value str">&quot;&lt;option&gt;&lt;/option&gt;&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">items</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;&lt;option value='#{item.id}' id='#{id}_#{item.id}'&gt;#{h item.scaffold_name}&lt;/option&gt;&quot;</span>}.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>))
467:         <span class="ruby-keyword kw">end</span>
468:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000022" class="method-detail">
        <a name="M000022"></a>

        <div class="method-heading">
          <a href="#M000022" class="method-signature">
          <span class="method-name">association_select_tag</span><span class="method-args">(record, association)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a select box displaying all possible records in the associated
model that can be associated with this model. If scaffold autocompleting is
turned on for the associated model, uses an autocompleting text box.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000022-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000022-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/scaffolding_extensions/lib/scaffolding_extensions.rb, line 443</span>
443:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">association_select_tag</span>(<span class="ruby-identifier">record</span>, <span class="ruby-identifier">association</span>)
444:         <span class="ruby-identifier">reflection</span> = <span class="ruby-identifier">record</span>.<span class="ruby-identifier">camelize</span>.<span class="ruby-identifier">constantize</span>.<span class="ruby-identifier">reflect_on_association</span>(<span class="ruby-identifier">association</span>)
445:         <span class="ruby-identifier">foreign_key</span> = <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:foreign_key</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">classify</span>.<span class="ruby-identifier">foreign_key</span>
446:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">scaffold_use_auto_complete</span>
447:           <span class="ruby-identifier">scaffold_text_field_with_auto_complete</span>(<span class="ruby-identifier">record</span>, <span class="ruby-identifier">foreign_key</span>, <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">underscore</span>)
448:         <span class="ruby-keyword kw">else</span>
449:           <span class="ruby-identifier">items</span> = <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">scaffold_select_order</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">interpolate_conditions</span>(<span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:conditions</span>]), <span class="ruby-identifier">:include=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">scaffold_include</span>)
450:           <span class="ruby-identifier">select</span>(<span class="ruby-identifier">record</span>, <span class="ruby-identifier">foreign_key</span>, <span class="ruby-identifier">items</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">i</span>.<span class="ruby-identifier">scaffold_name</span>, <span class="ruby-identifier">i</span>.<span class="ruby-identifier">id</span>]}, {<span class="ruby-identifier">:include_blank=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span>})
451:         <span class="ruby-keyword kw">end</span>
452:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000021" class="method-detail">
        <a name="M000021"></a>

        <div class="method-heading">
          <a href="#M000021" class="method-signature">
          <span class="method-name">default_input_block</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Create html fragment for field for record_name and column
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000021-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000021-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/scaffolding_extensions/lib/scaffolding_extensions.rb, line 436</span>
436:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">default_input_block</span>
437:         <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">record_name</span>, <span class="ruby-identifier">column</span><span class="ruby-operator">|</span> <span class="ruby-identifier">input_tag_wrapper</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">input_tag_label_and_widget</span>(<span class="ruby-identifier">record_name</span>, <span class="ruby-identifier">column</span>))}
438:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000018" class="method-detail">
        <a name="M000018"></a>

        <div class="method-heading">
          <a href="#M000018" class="method-signature">
          <span class="method-name">input_tag_label_and_widget</span><span class="method-args">(record_name, column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get label and widget for record_name and column
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000018-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000018-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/scaffolding_extensions/lib/scaffolding_extensions.rb, line 414</span>
414:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">input_tag_label_and_widget</span>(<span class="ruby-identifier">record_name</span>, <span class="ruby-identifier">column</span>)
415:           <span class="ruby-identifier">column_name</span> = <span class="ruby-identifier">column</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">column</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">:to_s</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">:name</span>)
416:           <span class="ruby-identifier">label_id</span>, <span class="ruby-identifier">tag</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">column</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/Reflection/</span>
417:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">column</span>.<span class="ruby-identifier">macro</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:belongs_to</span>
418:             [<span class="ruby-node">&quot;#{record_name}_#{column.options[:foreign_key] || column.klass.table_name.classify.foreign_key}&quot;</span>, <span class="ruby-identifier">association_select_tag</span>(<span class="ruby-identifier">record_name</span>, <span class="ruby-identifier">column_name</span>)]
419:           <span class="ruby-keyword kw">else</span>
420:             [<span class="ruby-node">&quot;#{record_name}_#{column_name}&quot;</span>, <span class="ruby-identifier">input</span>(<span class="ruby-identifier">record_name</span>, <span class="ruby-identifier">column_name</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">text_field</span>(<span class="ruby-identifier">record_name</span>, <span class="ruby-identifier">column_name</span>)]
421:           <span class="ruby-keyword kw">end</span>
422:           [<span class="ruby-node">&quot;&lt;label for='#{label_id}'&gt;#{@scaffold_class ? @scaffold_class.scaffold_column_name(column_name) :  column_name.to_s.humanize}&lt;/label&gt;&quot;</span>, <span class="ruby-identifier">tag</span>]
423:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000020" class="method-detail">
        <a name="M000020"></a>

        <div class="method-heading">
          <a href="#M000020" class="method-signature">
          <span class="method-name">input_tag_wrapper</span><span class="method-args">(label, tag)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Wrap label and widget in table row
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000020-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000020-source">
<pre>
     <span class="ruby-comment cmt"># File vendor/plugins/scaffolding_extensions/lib/scaffolding_extensions.rb, line 431</span>
431:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">input_tag_wrapper</span>(<span class="ruby-identifier">label</span>, <span class="ruby-identifier">tag</span>)
432:           <span class="ruby-node">&quot;&lt;tr&gt;&lt;td&gt;#{label}&lt;/td&gt;&lt;td&gt;#{tag}&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>
433:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>